---
# # win baseline 1052 state
# - name: "win_baseline_1052_state | Ensure 'Devices - Allowed to format and eject removable media' is set to 'Administrators'"
#   win_regedit:
#     path: "{{ win_baseline_1052_state_Path }}"
#     name: "{{ win_baseline_1052_state_Name }}"
#     data: "{{ win_baseline_1052_state_Data }}"
#     type: "{{ win_baseline_1052_state_Type }}"
#   when:
#     win_baseline_1052_state_Manage
# # win baseline 1149 state
# - name: "win_baseline_1149_state | Ensure 'Microsoft network client - Digitally sign communications (always)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1149_state_Path }}"
#     name: "{{ win_baseline_1149_state_Name}}"
#     data: "{{ win_baseline_1149_state_Data }}"
#     type: "{{ win_baseline_1149_state_Type }}"
#   when:
#     win_baseline_1149_state_Manage
# # win baseline 1153 state
# - name: "win_baseline_1153_state | Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1153_state_Path }}"
#     name: "{{ win_baseline_1153_state_Name }}"
#     data: "{{ win_baseline_1153_state_Data }}"
#     type: "{{ win_baseline_1153_state_Type }}"
#   when:
#     win_baseline_1153_state_Manage
# # win baseline 1155 state
# - name: "win_baseline_1155_state | Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '1'"
#   win_regedit:
#     path: "{{ win_baseline_1155_state_Path }}"
#     name: "{{ win_baseline_1155_state_Name }}"
#     data: "{{ win_baseline_1155_state_Data }}"
#     type: "{{ win_baseline_1155_state_Type }}"
#   when:
#     win_baseline_1155_state_Manage
# # win_baseline 5263 state
# - name: "win_baseline_5263_state | Ensure 'No auto-restart with logged on users for scheduled automatic updates installations' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_5263_state_Path }}"
#     name: "{{ win_baseline_5263_state_Name }}"
#     data: "{{ win_baseline_5263_state_Data }}"
#     type: "{{ win_baseline_5263_state_Type }}"
#   when:
#     win_baseline_5263_state_Manage
# # win baseline 7805 state
# - name: "win_baseline_7805_state | Ensure 'Configure Automatic Updates' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_7805_state_Path }}"
#     name: "{{ win_baseline_7805_state_Name }}"
#     data: "{{ win_baseline_7805_state_Data }}"
#     type: "{{ win_baseline_7805_state_Type }}"
#   when:
#     win_baseline_7805_state_Manage
# # win baseline 8248 state
# - name: "win_baseline_8248_state | Ensure 'Allow Digest Authentication' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_8248_state_Path }}"
#     name: "{{ win_baseline_8248_state_Name }}"
#     data: "{{ win_baseline_8248_state_Data }}"
#     type: "{{ win_baseline_8248_state_Type }}"
#   when:
#     win_baseline_8248_state_Manage

# -----------------------
# Windows total playbooks
# -----------------------

# - name: "win_baseline_1071_state | Ensure 'Minimum password length' is set to '14 or more character(s)'"
#   win_security_policy:
#     section: "{{ win_baseline_1071_state_Section }}"
#     key: "{{ win_baseline_1071_state_Key }}"
#     value: "{{ win_baseline_1071_state_Value }}"
#   when:
#     win_baseline_1071_state_Manage

# - name: "win_baseline_1072_state | Ensure 'Minimum password age' is set to '1 or more day(s)' [GSA-0]"
#   win_security_policy:
#     section: "{{win_baseline_1072_state_Section }}"
#     key: "{{ win_baseline_1072_state_Key }}"
#     value: "{{ win_baseline_1072_state_Value }}"
#   when:
#     win_baseline_1072_state_Manage

# - name: "win_baseline_1091_state | Ensure 'Interactive logon - Prompt user to change password before expiration' is set to 'between 5 and 14 days'"
#   win_regedit:
#     path: "{{ win_baseline_1091_state_Path }}"
#     name: "{{ win_baseline_1091_state_Name }}"
#     data: "{{ win_baseline_1091_state_Data }}"
#     type: "{{ win_baseline_1091_state_Type }}"
#   when:
#     win_baseline_1091_state_Manage

# - name: "win_baseline_1092_state | Ensure 'Password Complexity Requirements' is set to 'Enabled'"
#   win_security_policy:
#     section: "{{ win_baseline_1092_state_Section }}"
#     key: "{{ win_baseline_1092_state_Key }}"
#     value: "{{ win_baseline_1092_state_Value }}"
#   when:
#     win_baseline_1092_state_Manage

# ! The service module cannot be installed
# - block:
#   - name: Get DHCP Client service info
#     win_service_info:
#       name: Dhcp
#     register: dhcp_service_info

#   - name: Stop dependent services
#     win_service:
#       name: "{{ item }}"
#       state: stopped
#     loop: "{{ dhcp_service_info.service.DependentServices }}"

#   - name: Ensure DHCP Client is set to Disabled
#     ansible.windows.win_service_info:
#       name: Dhcp
#       state: stopped
#       start_mode: disabled
  
# - name: "win_baseline_1115_state | Ensure Dynamic Host Configuration Protocol (DHCP) Client' is set to 'Disabled'"
#   win_service:
#     name: "{{ win_baseline_1115_state_Name }}"
#     state: "{{ win_baseline_1115_state_State }}"
#     start_mode: "{{ win_baseline_1115_state_Mode }}"
#   when:
#     win_baseline_1115_state_Manage

# - name: "win_baseline_1134_state | Ensure 'Logon banner title' is ser to 'This is an interest computer system of ABB Asea Brown Boveri Ltd'"
#   win_regedit:
#     path: "{{ win_baseline_1134_state_Path }}"
#     name: "{{ win_baseline_1134_state_Name }}"
#     data: "{{ win_baseline_1134_state_Data }}"
#     type: "{{ win_baseline_1134_state_Type }}"
#   when:
#     win_baseline_1134_state_Manage

# - name: "win_baseline_1156_state | Ensure 'Audit - Shut down system immediately if unable to log security audits' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1156_state_Path }}"
#     name: "{{ win_baseline_1156_state_Name }}"
#     data: "{{ win_baseline_1156_state_Data }}"
#     type: "{{ win_baseline_1156_state_Type }}"
#   when:
#     win_baseline_1156_state_Manage

# - name: "win_baseline_1162_state | Ensure 'Devices: Restrict floppy access to locally logged-on user only' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1162_state_Path }}"
#     name: "{{ win_baseline_1162_state_Name }}"
#     data: "{{ win_baseline_1162_state_Data }}"
#     type: "{{ win_baseline_1162_state_Type }}"
#   when:
#     win_baseline_1162_state_Manage

# - name: "win_baseline_1163_state | Ensure 'Devices - Prevent users from installing printer drivers' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1163_state_Path }}"
#     name: "{{ win_baseline_1163_state_Name }}"
#     data: "{{ win_baseline_1163_state_Data }}"
#     type: "{{ win_baseline_1163_state_Type }}"
#   when:
#     win_baseline_1163_state_Manage

# - name: "win_baseline_1164_state | Ensure 'Network security - Do not store LAN Manager hash value on next password change' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1164_state_Path }}"
#     name: "{{ win_baseline_1164_state_Name }}"
#     data: "{{ win_baseline_1164_state_Data }}"
#     type: "{{ win_baseline_1164_state_Type }}"
#   when:
#     win_baseline_1164_state_Manage

# - name: "win_baseline_1169_state | Ensure 'MSS - (AutoAdminLogon) Enable Automatic Logon (not recommended)' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1169_state_Path }}"
#     name: "{{ win_baseline_1169_state_Name }}"
#     data: "{{ win_baseline_1169_state_Data }}"
#     type:  "{{ win_baseline_1169_state_Type }}"
#   when:
#     win_baseline_1169_state_Manage

# 2.7
# - name: "win_baseline_1172_state | Ensure 'MSS - (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' is set"
#   win_regedit:
#     path: "{{ win_baseline_1172_state_Path }}"
#     name: "{{ win_baseline_1172_state_Name }}"
#     data: "{{ win_baseline_1172_state_Data }}"
#     type: "{{ win_baseline_1172_state_Type }}"
#   when:
#     win_baseline_1172_state_Manage

# - name: "win_baseline_1176_state | Devices: Restrict CD-ROM access to locally logged-on user only"
#   win_regedit:
#     path: "{{ win_baseline_1176_state_Path }}"
#     name: "{{ win_baseline_1176_state_Name }}"
#     data: "{{ win_baseline_1176_state_Data }}"
#     type: "{{ win_baseline_1176_state_Type }}"
#   when:
#     win_baseline_1176_state_Manage

# - name: "win_baseline_1177_state | Enure 'Enable IPSec protect Kerberos RSVP traffic' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1177_state_Path }}"
#     name: "{{ win_baseline_1177_state_Name }}"
#     data: "{{ win_baseline_1177_state_Data }}"
#     type: "{{ win_baseline_1177_state_Type }}"
#   when:
#     win_baseline_1177_state_Manage

# ! not sure
# - name: "win_baseline_1181_state | Ensure 'Simple Netowrk Management Protocol trap' service is diabled"
#   win_service:
#     name: snmptrap
#     state: stopped
#     enabled: no
#   when:
#     win_baseline_1181_state_Manage

# - name: "win_baseline_1183_state | Ensure 'Autorun for all drivers' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1183_state_Path }}"
#     name: "{{ win_baseline_1183_state_Name }}"
#     data: "{{ win_baseline_1183_state_Data }}"
#     type: "{{ win_baseline_1183_state_Type }}"
#   when:
#     win_baseline_1183_state_Manage

# - name: "win_baseline_1184_state | Ensure 'MSS - (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1184_state_Path }}"
#     name: "{{ win_baseline_1184_state_Name }}"
#     data: "{{ win_baseline_1184_state_Data }}"
#     type: "{{ win_baseline_1184_state_Type }}"
#   when:
#     win_baseline_1184_state_Manage

# - name: "win_baseline_1188_state | Ensure 'System objects - Require case insensitivity for non-Windows subsystems' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1188_state_Path }}"
#     name: "{{ win_baseline_1188_state_Name }}"
#     data: "{{ win_baseline_1188_state_Data }}"
#     type: "{{ win_baseline_1188_state_Type }}"
#   when:
#     win_baseline_1188_state_Manage

# - name: "win_baseline_1189_state | Ensure 'Microsoft network server - Digitally sign communications (always)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1189_state_Path }}"
#     name: "{{ win_baseline_1189_state_Name }}"
#     data: "{{ win_baseline_1189_state_Data }}"
#     type: "{{ win_baseline_1189_state_Type }}"
#   when:
#     win_baseline_1189_state_Manage

# - name: "win_baseline_1190_state | Ensure 'Interactive logon - Do not display last user name' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1190_state_Path }}"
#     name: "{{ win_baseline_1190_state_Name }}"
#     data: "{{ win_baseline_1190_state_Data }}"
#     type: "{{ win_baseline_1190_state_Type }}"
#   when: 
#     win_baseline_1190_state_Manage

# - name: "win_baseline_1193_state | Ensure 'MSS - (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1193_state_Path }}"
#     name: "{{ win_baseline_1193_state_Name }}"
#     data:  "{{ win_baseline_1193_state_Data }}"
#     type: "{{ win_baseline_1193_state_Type }}"
#   when:
#     win_baseline_1193_state_Manage

# - name: "win_baseline_1195_state | Ensure 'MSS - (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set"
#   win_regedit:
#     path: "{{ win_baseline_1195_state_Path }}"
#     name: "{{ win_baseline_1195_state_Name }}"
#     data: "{{ win_baseline_1195_state_Data }}"
#     type: "{{ win_baseline_1195_state_Type }}"
#   when:
#     win_baseline_1195_state_Manage

# - name: "win_baseline_1196_state | Ensure 'MSS - (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' is set to 'Enabled - 5 or fewer seconds'"
#   win_regedit:
#     path: "{{ win_baseline_1196_state_Path }}"
#     name: "{{ win_baseline_1196_state_Name }}"
#     data: "{{ win_baseline_1196_state_Data }}"
#     type: "{{ win_baseline_1196_state_Type }}"
#   when:
#     win_baseline_1196_state_Manage

# - name: "win_baseline_1197_state | Ensure 'Network access - Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1197_state_Path }}"
#     name: "{{ win_baseline_1197_state_Name }}"
#     data: "{{ win_baseline_1197_state_Data }}"
#     type: "{{ win_baseline_1197_state_Type }}"
#   when:
#     win_baseline_1197_state_Manage

# - name: "win_baseline_1199_state| Ensure 'Microsoft network server - Amount of idle time required before suspending session' is set to '15 or fewer, but not 0'"
#   win_regedit:
#     path: "{{ win_baseline_1199_state_Path }}"
#     name: "{{ win_baseline_1199_state_Name }}"
#     data: "{{ win_baseline_1199_state_Data }}"
#     type: "{{ win_baseline_1199_state_Type }}"
#   when:
#     win_baseline_1199_state_Manage

# ! not sure and does not work, do not know hot to modify the feature
# - name: "win_baseline_1200_state | Ensure 'Dynamic Controller: Resuse machine account password changes' is set to 'Disabled'"
#   win_security_policy:
#     section: "{{ win_baseline_1200_state_Section }}"
#     key: "{{ win_baseline_1200_state_Key }}"
#     value: "{{ win_baseline_1200_state_Value }}"
#   when:
#     win_baseline_1200_state_Manage

# - name: "win_baseline_1264_state | Ensure Dynamic Host Configuration Protocol Client' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1264_state_Path }}"
#     name: "{{ win_baseline_1264_state_Name }}"
#     data: "{{ win_baseline_1264_state_Data }}"
#     type: "{{ win_baseline_1264_state_Type }}"
#   when:
#     win_baseline_1264_state_Manage

# ! not sure
# - name: "win_baseline_1318_state | Ensure 'Enforce password history' is set to '24 or more password(s)'"
#   win_security_policy:
#     section: System Access
#     key: PasswordHistorySize
#     value: 24

# - name: "win_baseline_1366_state | Ensure 'Accounts - Limit local account use of blank passwords to console logon only' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1366_state_Path }}"
#     name: "{{ win_baseline_1366_state_Name }}"
#     data: "{{ win_baseline_1366_state_Data }}"
#     type: "{{ win_baseline_1366_state_Type }}"
#   when:
#     win_baseline_1366_state_Manage

# - name: "win_baseline_1368_state | Ensure 'Print Spooler' service is set to 'Automatic'"
#   win_regedit:
#     path: "{{ win_baseline_1368_state_Path }}"
#     name: "{{ win_baseline_1368_state_Name }}"
#     data: "{{ win_baseline_1368_state_Data }}"
#     type: "{{ win_baseline_1368_state_Type }}"
#   when:
#     win_baseline_1368_state_Manage

# - name: "win_baseline_1369_state | Ensure 'Shutdown - Allow system to be shut down without having to log on' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1369_state_Path }}"
#     name: "{{ win_baseline_1369_state_Name }}"
#     data: "{{ win_baseline_1369_state_Data }}"
#     type: "{{ win_baseline_1369_state_Type }}"
#   when:
#     win_baseline_1369_state_Manage

# - name: "win_baseline_1370_state | Ensure 'Domain member - Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1370_state_Path }}"
#     name: "{{ win_baseline_1370_state_Name }}"
#     data: "{{ win_baseline_1370_state_Data }}"
#     type: "{{ win_baseline_1370_state_Type }}"
#   when:
#     win_baseline_1370_state_Manage

# - name: "win_baseline_1371_state | Ensure 'Domain member - Digitally encrypt secure channel data (when possible)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1371_state_Path }}"
#     name: "{{ win_baseline_1371_state_Name }}"
#     data: "{{ win_baseline_1371_state_Data }}"
#     type: "{{ win_baseline_1371_state_Type }}"
#   when:
#     win_baseline_1371_state_Manage

# - name: "win_baseline_1372_state | Ensure 'Domain member - Digitally sign secure channel data (when possible)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1372_state_Path }}"
#     name: "{{ win_baseline_1372_state_Name }}"
#     data: "{{ win_baseline_1372_state_Data }}"
#     type: "{{ win_baseline_1372_state_Type }}"
#   when:
#     win_baseline_1372_state_Manage

# - name: "win_baseline_1173_state | Ensure 'Domain member - Disable machine account password changes' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1173_state_Path }}"
#     name: "{{ win_baseline_1173_state_Name }}"
#     data: "{{ win_baseline_1173_state_Data }}"
#     type: "{{ win_baseline_1173_state_Type }}"
#   when:
#     win_baseline_1173_state_Manage

# - name: "win_baseline_1374_state | Ensure 'Domain member - Maximum machine account password age' is set to '30 or fewer days, but not 0'"
#   win_regedit:
#     path: "{{ win_baseline_1374_state_Path }}"
#     name: "{{ win_baseline_1374_state_Name }}"
#     data: "{{ win_baseline_1374_state_Data }}"
#     type: "{{ win_baseline_1374_state_Type }}"
#   when:
#     win_baseline_1374_state_Manage

# - name: "win_baseline_1375_state | Ensure 'Domain member - Require strong (Windows 2000 or later) session key' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1375_state_Path }}"
#     name: "{{ win_baseline_1375_state_Name }}"
#     data: "{{ win_baseline_1375_state_Data }}"
#     type: "{{ win_baseline_1375_state_Type }}"
#   when:
#     win_baseline_1375_state_Manage

# - name: "win_baseline_1376_state | Ensure 'Interactive logon - Do not require CTRL+ALT+DEL' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1376_state_Path }}"
#     name: "{{ win_baseline_1376_state_Name }}"
#     data: "{{ win_baseline_1376_state_Data }}"
#     type: "{{ win_baseline_1376_state_Type }}"
#   when:
    # win_baseline_1376_state_Manage

# - name: "win_baseline_1377_state | Ensure 'Interactive logon - Require Domain Controller Authentication to unlock workstation' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1377_state_Path }}"
#     name: "{{ win_baseline_1377_state_Name }}"
#     data: "{{ win_baseline_1377_state_Data }}"
#     type: "{{ win_baseline_1377_state_Type }}"
#   when:
#     win_baseline_1377_state_Manage

# # ! problem
# - name: "win_baseline_1378_state | Ensure 'Interactive logon - Smart card removal behavior' is set to 'Lock Workstation'"
#   win_regedit:
#     path: "{{ win_baseline_1378_state_Path }}"
#     name: "{{ win_baseline_1378_state_Name }}"
#     data: "{{ win_baseline_1378_state_Data }}"
#     type: "{{ win_baseline_1378_state_Type }}"
#   when:
#     win_baseline_1378_state_Manage

# - name: "win_baseline_1379_state | Ensure 'Microsoft network client - Digitally sign communications (if server agrees)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1379_state_Path }}"
#     name: "{{ win_baseline_1379_state_Name }}"
#     data: "{{ win_baseline_1379_state_Data }}"
#     type: "{{ win_baseline_1379_state_Type }}"
#   when:
#     win_baseline_1379_state_Manage

# - name: "win_baseline_1380_state | Ensure 'Microsoft network client - Send unencrypted password to third-party SMB servers' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1380_state_Path }}"
#     name: "{{ win_baseline_1380_state_Name }}"
#     data: "{{ win_baseline_1380_state_Data }}"
#     type: "{{ win_baseline_1380_state_Type }}"
#   when:
#     win_baseline_1380_state_Manage

# - name: "win_baseline_1381_state | Ensure 'Microsoft network server - Digitally sign communications (if client agrees)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1381_state_Path }}"
#     name: "{{ win_baseline_1381_state_Name }}"
#     data: "{{ win_baseline_1381_state_Data }}"
#     type:  "{{ win_baseline_1381_state_Type }}"
#   when:
#     win_baseline_1381_state_Manage

# - name: "win_baseline_1382_state | Ensure 'Microsoft network server - Disconnect clients when logon hours expire' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1382_state_Path }}"
#     name: "{{ win_baseline_1382_state_Name }}"
#     data: "{{ win_baseline_1382_state_Data }}"
#     type: "{{ win_baseline_1382_state_Type }}"
#   when:
#     win_baseline_1382_state_Manage

# - name: "win_baseline_1383_state | Ensure 'Network access - Let Everyone permissions apply to anonymous users' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1383_state_Path }}"
#     name: "{{ win_baseline_1383_state_Name }}"
#     data: "{{ win_baseline_1383_state_Data }}"
#     type: "{{ win_baseline_1383_state_Type }}"
#   when:
#     win_baseline_1383_state_Manage

# - name: "win_baseline_1386_state | Ensure 'Network access - Sharing and security model for local accounts' is 'Classic - local users authenticate as themselves'"
#   win_regedit:
#     path: "{{ win_baseline_1386_state_Path }}"
#     name: "{{ win_baseline_1386_state_Name }}"
#     data: "{{ win_baseline_1386_state_Data }}"
#     type: "{{ win_baseline_1386_state_Type }}"
#   when:
#     win_baseline_1386_state_Manage

# - name: "win_baseline_1387_state | Ensure 'Network security - LAN Manager authentication level' is set to 'Send NTLMv2 response only. Refuse LM&NTLM'"
#   win_regedit:
#     path: "{{ win_baseline_1387_state_Path }}"
#     name: "{{ win_baseline_1387_state_Name }}"
#     data: "{{ win_baseline_1387_state_Data }}"
#     type: "{{ win_baseline_1387_state_Type }}"
#   when:
#     win_baseline_1387_state_Manage

# - name: "win_baseline_1388_state | Ensure 'Network security - LDAP client signing requirements' is set to 'Negotiate signing' or higher"
#   win_regedit:
#     path: "{{ win_baseline_1388_state_Path }}"
#     name: "{{ win_baseline_1388_state_Name }}"
#     data: "{{ win_baseline_1388_state_Data }}"
#     type: "{{ win_baseline_1388_state_Type }}"
#   when:
#     win_baseline_1388_state_Manage

# - name: "win_baseline_1389_state | Ensure 'Network security - Minimum session security for NTLM SSP based (including secure RPC) clients' is set to 'Require NTLMv2 session security, Require 128-bit encryption'"
#   win_regedit:
#     path: "{{ win_baseline_1389_state_Path }}"
#     name: "{{ win_baseline_1389_state_Name }}"
#     data: "{{ win_baseline_1389_state_Data }}"
#     type: "{{ win_baseline_1389_state_Type }}"
#   when:
#     win_baseline_1389_state_Manage

# - name: "win_baseline_1390_state | Ensure 'Network security - Minimum session security for NTLM SSP based (including secure RPC) servers' is set to 'Require NTLMv2 session security, Require 128-bit encryption'"
#   win_regedit:
#     path: "{{ win_baseline_1390_state_Path }}"
#     name: "{{ win_baseline_1390_state_Name }}"
#     data: "{{ win_baseline_1390_state_Data }}"
#     type: "{{ win_baseline_1390_state_Type }}"
#   when:
#     win_baseline_1390_state_Manage

# - name: "win_baseline_1391_state | Ensure 'Recovery Console: Allow automatic administrative logon' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1391_state_Path }}"
#     name: "{{ win_baseline_1391_state_Name }}"
#     data: "{{ win_baseline_1391_state_Data }}"
#     type: "{{ win_baseline_1391_state_Type }}"
#   when:
#     win_baseline_1391_state_Manage

# - name: "win_baseline_1392_state | Ensure 'Recovery Console: Allow floppy copy and access to all drives and all folders' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1392_state_Path }}"
#     name: "{{ win_baseline_1392_state_Name }}"
#     data: "{{ win_baseline_1392_state_Data }}"
#     type: "{{ win_baseline_1392_state_Type }}"
#   when:
#     win_baseline_1392_state_Manage

# - name: "win_baseline_1426_state | Ensure 'System objects - Strengthen default permissions of internal system objects (e.g. Symbolic Links)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1426_state_Path }}"
#     name: "{{ win_baseline_1426_state_Name }}"
#     data: "{{ win_baseline_1426_state_Data }}"
#     type: "{{ win_baseline_1426_state_Type }}"
#   when:
#     win_baseline_1426_state_Manage

# - name: "win_baseline_1430_state | Ensure 'Terminal Services' is set to 'Automatic'"
#   win_regedit:
#     path: "{{ win_baseline_1430_state_Path }}"
#     name: "{{ win_baseline_1430_state_Name }}"
#     data: "{{ win_baseline_1430_state_Data }}"
#     type: "{{ win_baseline_1430_state_Type }}"
#   when:
#     win_baseline_1430_state_Manage

# - name: "win_baseline_1432_state | Ensure 'Domain Controller: LDAP server signing requirements' is set to 'Require signing'"
#   win_regedit:
#     path: "{{ win_baseline_1432_state_Path }}"
#     name: "{{ win_baseline_1432_state_Name }}"
#     data: "{{ win_baseline_1432_state_Data }}"
#     type: "{{ win_baseline_1432_state_Type }}"
#   when:
#     win_baseline_1432_state_Manage

# - name: "win_baseline_1434_state | Ensure 'Network access: Rediect anonymous access to Named Pipes and Shares' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1434_state_Path }}"
#     name: "{{ win_baseline_1434_state_Name }}"
#     data: "{{ win_baseline_1434_state_Data }}"
#     type: "{{ win_baseline_1434_state_Type }}"
#   when:
#     win_baseline_1434_state_Manage

# - name: "win_baseline_1436_state | Ensure 'System crytography: Force strong key protection for user keys stored on the computer' is set to 'User must enter a password each time they use a key'"
#   win_regedit:
#     path: "{{ win_baseline_1436_state_Path }}"
#     name: "{{ win_baseline_1436_state_Name }}"
#     data: "{{ win_baseline_1436_state_Data }}"
#     type: "{{ win_baseline_1436_state_Type }}"
#   when:
#     win_baseline_1436_state_Manage

# - name: "win_baseline_1458_state | Ensure 'MSS - (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_1458_state_Path }}"
#     name: "{{ win_baseline_1458_state_Name }}"
#     data: "{{ win_baseline_1458_state_Data }}"
#     type: "{{ win_baseline_1458_state_Type }}"
#   when:
#     win_baseline_1458_state_Manage

# - name: "win_baseline_1463_state | Ensure 'MSS - (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set"
#   win_regedit:
#     path: "{{ win_baseline_1463_state_Path }}"
#     name: "{{ win_baseline_1463_state_Name }}"
#     data: "{{ win_baseline_1463_state_Data }}"
#     type: "{{ win_baseline_1463_state_Type }}"
#   when:
#     win_baseline_1463_state_Manage

# - name: "win_baseline_1476_state | Ensure 'Romote Access Connection Manager (RasMan)' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1476_state_Path }}"
#     name: "{{ win_baseline_1476_state_Name }}"
#     data: "{{ win_baseline_1476_state_Data }}"
#     type: "{{ win_baseline_1476_state_Type }}"
#   when:
#     win_baseline_1476_state_Manage

# - name: "win_baseline_1509_state | Ensure 'Netlogon' is set to 'Automatic'"
#   win_regedit:
#     path: "{{ win_baseline_1509_state_Path }}"
#     name: "{{ win_baseline_1509_state_Name }}"
#     data: "{{ win_baseline_1509_state_Data }}"
#     type: "{{ win_baseline_1509_state_Type }}"
#   when:
#     win_baseline_1509_state_Manage

# - name: "win_baseline_1510_state | Ensure 'Routing and Remote Access' is set to 'Disabled'"
#   win_regedit:
#     path: "{{ win_baseline_1510_state_Path }}"
#     name: "{{ win_baseline_1510_state_Name }}"
#     data: "{{ win_baseline_1510_state_Data }}"
#     type: "{{ win_baseline_1510_state_Type }}"
#   when:
#     win_baseline_1510_state_Manage

# - name: "win_baseline_1514_state | Ensure 'Restrictions for Unauthenticated RPC clients' is set to 'Authenticated without exceptions'"
#   win_regedit:
#     path: "{{ win_baseline_1514_state_Path }}"
#     name: "{{ win_baseline_1514_state_Name }}"
#     data: "{{ win_baseline_1514_state_Data }}"
#     type: "{{ win_baseline_1514_state_Type }}"
#   when:
#     win_baseline_1514_state_Manage

# - name: "win_baseline_2181_state | Ensure 'Access this computer from the network' is set to 'Administrators, Authenticated Users'"
#   win_user_right:
#     name: "{{ win_baseline_2181_state_Name }}"
#     users: "{{ win_baseline_2181_state_Users }}"
#     action: "{{ win_baseline_2181_state_Action }}"
#   when:
#     win_baseline_2181_state_Manage

# ! not sure
# - name: "win_baseline_2182_state | Ensure 'Act as part of the operating system' is set to 'No One'"
#   win_user_right:
#     name: SeTcbPrivilege
#     users:
#     action: set
#   ignore_errors: yes

# ! not sure
# - name: "win_baseline_2183_state | Ensure 'Add workstations to domain' is set to 'Administrators'"
#   win_user_right:
#     name: "{{ win_baseline_2183_state_Name }}"
#     users: "{{ win_baseline_2183_state_Users }}"
#     action: "{{ win_baseline_2183_state_Action }}"
#   when:
#     win_baseline_2183_state_Manage

# The following tasks should be test one by one, to find the credential problem.
# - name: "win_baseline_2341_state | Ensure 'Account lockout duration' is set to '30 or more minute(s)'"
#   win_security_policy:
#     section: "{{ win_baseline_2341_state_Section }}"
#     key: "{{ win_baseline_2341_state_Key }}"
#     value: "{{ win_baseline_2341_state_Value }}"
#   when:
#     win_baseline_2341_state_Manage

# - name: "win_baseline_2342_state | Ensure 'Account lockout threshold' is set to '10 or fewer invalid logon attempt(s), but not 0'"
#   win_security_policy:
#     section: "{{ win_baseline_2342_state_Section }}"
#     key: "{{ win_baseline_2342_state_Key }}"
#     value: "{{ win_baseline_2342_state_Value }}"
#   when:
#     win_baseline_2342_state_Manage

# - name: "win_baseline_2343_state | Ensure 'Reset account lockout counter after' is set to '30 or less minute(s)'"
#   win_security_policy:
#     section: "{{ win_baseline_2343_state_Section }}"
#     key: "{{ win_baseline_2343_state_Key }}"
#     value: "{{ win_baseline_2343_state_Value }}"
#   when:
#     win_baseline_2343_state_Manage

# - name: "win_baseline_2484_state | Ensure 'Store passwords using reversible encryption' is set to 'Disabled'"
#   win_security_policy:
#     section: "{{ win_baseline_2484_state_Section }}"
#     key: "{{ win_baseline_2484_state_Key }}"
#     value: "{{ win_baseline_2484_state_Value }}"
#   when:
#     win_baseline_2484_state_Manage

# - name: "win_baseline_2518_state | Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2518_state_Path }}"
#     name: "{{ win_baseline_2518_state_Name }}"
#     data: "{{ win_baseline_2518_state_Data }}"
#     type: "{{ win_baseline_2518_state_Type }}"
#   when:
#     win_baseline_2518_state_Manage

- name: "win_baseline_2582_state | Ensure 'User Account Control - Detect application installations and prompt for elevation' is set to 'Enabled'"
  win_regedit:
    path: "{{ win_baseline_2582_state_Path }}"
    name: "{{ win_baseline_2582_state_Name }}"
    data: "{{ win_baseline_2582_state_Data }}"
    type: "{{ win_baseline_2582_state_Type }}"
  when:
    win_baseline_2582_state_Manage

# - name: "win_baseline_2583_state | Ensure 'User Account Control - Run all administrators in Admin Approval Mode' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2583_state_Path }}"
#     name: "{{ win_baseline_2583_state_Name }}"
#     data: "{{ win_baseline_2583_state_Data }}"
#     type: "{{ win_baseline_2583_state_Type }}"
#   when:
#     win_baseline_2583_state_Manage

# - name: "win_baseline_2584_state | Ensure 'User Account Control - Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2584_state_Path }}"
#     name: "{{ win_baseline_2584_state_Name }}"
#     data: "{{ win_baseline_2584_state_Data }}"
#     type: "{{ win_baseline_2584_state_Type }}"
#   when:
#     win_baseline_2584_state_Manage

# ! The result of this task might block the host, and throw the credential error.
# - name: "win_baseline_2586_state | Ensure 'User Account Control - Admin Approval Mode for the Built-in Administrator account' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2586_state_Path }}"
#     name: "{{ win_baseline_2586_state_Name }}"
#     data: "{{ win_baseline_2586_state_Data }}"
#     type: "{{ win_baseline_2586_state_Type }}"
#   when:
#     win_baseline_2586_state_Manage

# - name: "win_baseline_2587_state | Ensure 'User Account Control - Behavior of the elevation prompt for administrators in Admin Approval Mode' is set to 'Prompt for consent on the secure desktop'"
#   win_regedit:
#     path: "{{ win_baseline_2587_state_Path }}"
#     name: "{{ win_baseline_2587_state_Name }}"
#     data: "{{ win_baseline_2587_state_Data }}"
#     type: "{{ win_baseline_2587_state_Type }}"
#   when:
#     win_baseline_2587_state_Manage

# - name: "win_baseline_2605_state | Ensure 'User Account Control - Behavior of the elevation prompt for standard users' is 'Automatically deny elevation requests'"
#   win_regedit:
#     path: "{{ win_baseline_2605_state_Path }}"
#     name: "{{ win_baseline_2605_state_Name }}"
#     data: "{{ win_baseline_2605_state_Data }}"
#     type: "{{ win_baseline_2605_state_Type }}"
#   when:
#     win_baseline_2605_state_Manage

# - name: "win_baseline_2606_state | Ensure 'User Account Control - Switch to the secure desktop when prompting for elevation' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2606_state_Path }}"
#     name: "{{ win_baseline_2606_state_Name }}"
#     data: "{{ win_baseline_2606_state_Data }}"
#     type: "{{ win_baseline_2606_state_Type }}"
#   when:
#     win_baseline_2606_state_Manage

# - name: "win_baseline_2607_state | Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2607_state_Path }}"
#     name: "{{ win_baseline_2607_state_Name }}"
#     data: "{{ win_baseline_2607_state_Data }}"
#     type: "{{ win_baseline_2607_state_Type }}"
#   when:
#     win_baseline_2607_state_Manage

# - name: "win_baseline_2608_state | Ensure 'Audit - Force audit policy subcategory settings to override audit policy category settings' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2608_state_Path }}"
#     name: "{{ win_baseline_2608_state_Name }}"
#     data: "{{ win_baseline_2608_state_Data }}"
#     type: "{{ win_baseline_2608_state_Type }}"
#   when:
#     win_baseline_2608_state_Manage

# - name: "win_baseline_2610_state | Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2610_state_Path }}"
#     name: "{{ win_baseline_2610_state_Name }}"
#     data: "{{ win_baseline_2610_state_Data }}"
#     type: "{{ win_baseline_2610_state_Type }}"
#   when:
#     win_baseline_2610_state_Manage

# - name: "win_baseline_2612_state | Ensure 'Turn off downloading of enclosures' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2612_state_Path }}"
#     name: "{{ win_baseline_2612_state_Name }}"
#     data: "{{ win_baseline_2612_state_Data }}"
#     type: "{{ win_baseline_2612_state_Type }}"
#   when:
#     win_baseline_2612_state_Manage

# # TODO 2612: cannot find the property in the registry

# - name: "win_baseline_2616_state | Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'"
#   win_regedit:
#     path: "{{ win_baseline_2616_state_Path }}"
#     name: "{{ win_baseline_2616_state_Name }}"
#     data: "{{ win_baseline_2616_state_Data }}"
#     type: "{{ win_baseline_2616_state_Type }}"
#   when:
#     win_baseline_2616_state_Manage

# - name: "win_baseline_2635_state | Ensure 'Set client connection encryption level' is set to 'Enabled - High Level'"
#   win_regedit:
#     path: "{{ win_baseline_2635_state_Path }}"
#     name: "{{ win_baseline_2635_state_Name }}"
#     data: "{{ win_baseline_2635_state_Data }}"
#     type: "{{ win_baseline_2635_state_Type }}"
#   when:
#     win_baseline_2635_state_Manage

# - name: "win_baseline_3376_state | Ensure 'Maximum password age' is set to '60 or fewer days, but not 0'"
#   win_security_policy:
#     section: "{{ win_baseline_3376_state_Section }}"
#     key: "{{ win_baseline_3376_state_Key }}"
#     value: "{{ win_baseline_3376_state_Value }}"
#   when:
#     win_baseline_3376_state_Manage

# - name: "win_baseline_3657_state | Ensure 'Network access - Allow anonymous SID/Name translation' is set to 'Disabled'"
#   win_security_policy:
#     section: System Access
#     key: LSAAnonymousNameLookup
#     value: 0